<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="css/admin.css" />
    <link
      rel="shortcut icon"
      href="images/places/Favicom1.jpg"
      type="image/x-icon"
    />
  </head>
  <body>
    <h1>Admin Dashboard</h1>
    <div class="container">
      <!-- Add Flight Form -->
      <div class="form-section">
        <h2>Add Flight</h2>
        <form
          id="addFlightForm"
          method="POST"
          enctype="multipart/form-data"
          action="admin-dash.php"
        >
          <input type="hidden" name="action" value="add" />
          <input type="hidden" name="id" />
          <input
            type="text"
            id="flight_name"
            name="flight_name"
            placeholder="Flight Name"
            required
          />
          <input
            type="text"
            id="origin"
            name="origin"
            placeholder="Origin"
            required
          />
          <input
            type="text"
            id="destination"
            name="destination"
            placeholder="Destination"
            required
          />
          <input
            type="number"
            id="price"
            name="price"
            placeholder="Price"
            required
          />
          <input
            type="date"
            id="travel_date"
            name="travel_date"
            placeholder="Travel Date"
            required
          />
          <select id="class" name="class" required>
            <option value="business">Business</option>
            <option value="economy">Economy</option>
          </select>
          <input type="file" id="flight_image" name="image" required />
          <button type="submit">Add Flight</button>
        </form>
      </div>

      <!-- Add Hotel Form -->
      <div class="form-section">
        <h2>Add Hotel</h2>
        <form
          id="addHotelForm"
          method="POST"
          enctype="multipart/form-data"
          action="add_hotel.php"
        >
          <input type="hidden" name="action" value="add" />
          <input type="hidden" name="id" />
          <input
            type="text"
            id="hotel_name"
            name="name"
            placeholder="Hotel Name"
            required
          />
          <input
            type="text"
            id="hotel_location"
            name="location"
            placeholder="Location"
            required
          />
          <textarea
            id="hotel_services"
            name="services"
            placeholder="Services"
            required
          ></textarea>
          <textarea
            id="hotel_description"
            name="description"
            placeholder="Description"
            required
          ></textarea>
          <input type="file" id="hotel_image" name="image" required />
          <button type="submit">Add Hotel</button>
        </form>
      </div>

      <!-- Add Tourist Site Form -->
      <div class="form-section">
        <h2>Add Tourist Site</h2>
        <form
          id="addTouristSiteForm"
          method="POST"
          enctype="multipart/form-data"
          action="add_tourist_site.php"
        >
          <input type="hidden" name="action" value="add" />
          <input type="hidden" name="id" />
          <input
            type="text"
            id="site_name"
            name="name"
            placeholder="Site Name"
            required
          />
          <input
            type="text"
            id="site_location"
            name="location"
            placeholder="Location"
            required
          />
          <textarea
            id="site_description"
            name="description"
            placeholder="Description"
            required
          ></textarea>
          <input type="file" id="site_image" name="image" required />
          <button type="submit">Add Tourist Site</button>
        </form>
      </div>
    </div>

    <div class="data-section">
      <!-- Manage Flights -->
      <h2>Manage Flights</h2>
      <button onclick="addFlight()">Add Flight</button>
      <table id="flightsTable">
        <thead>
          <tr>
            <th>Flight Name</th>
            <th>Origin</th>
            <th>Destination</th>
            <th>Price</th>
            <th>Travel Date</th>
            <th>Class</th>
            <th>Image</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Flights data will be loaded here dynamically -->
        </tbody>
      </table>

      <!-- Manage Hotels -->
      <h2>Manage Hotels</h2>
      <button onclick="addHotel()">Add Hotel</button>
      <table id="hotelsTable">
        <thead>
          <tr>
            <th>Hotel Name</th>
            <th>Location</th>
            <th>Services</th>
            <th>Description</th>
            <th>Image</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Hotels data will be loaded here dynamically -->
        </tbody>
      </table>

      <!-- Manage Tourist Sites -->
      <h2>Manage Tourist Sites</h2>
      <button onclick="addTouristSite()">Add Tourist Site</button>
      <table id="touristSitesTable">
        <thead>
          <tr>
            <th>Site Name</th>
            <th>Location</th>
            <th>Description</th>
            <th>Image</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Tourist Sites data will be loaded here dynamically -->
        </tbody>
      </table>
    </div>

    <script>
      // Function to edit an entry (flight, hotel, or tourist site)
      function editEntry(type, id) {
        // Fetch the data of the entry to be edited
        fetch(`fetch_${type}.php?id=${id}`)
          .then((response) => response.json())
          .then((data) => {
            let form;
            if (type === "flight") {
              form = document.getElementById("addFlightForm");
            } else if (type === "hotel") {
              form = document.getElementById("addHotelForm");
            } else if (type === "tourist_site") {
              form = document.getElementById("addTouristSiteForm");
            }

            // Populate the form fields with the fetched data
            for (let key in data) {
              if (form.elements[key]) {
                form.elements[key].value = data[key];
              }
            }
            form.elements["action"].value = "edit";
            form.elements["id"].value = id;

            // Optionally, show the form if it's hidden
            // Example: form.style.display = 'block';
          });
      }

      // Function to delete an entry (flight, hotel, or tourist site)
      function deleteEntry(type, id) {
        let formData = new FormData();
        formData.append("type", type);
        formData.append("action", "delete");
        formData.append("id", id);

        fetch("manage_entries.php", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.text())
          .then((data) => {
            console.log(data);
            // Refresh data or update UI accordingly after deletion
            // Example: Reload the table data or remove the deleted row from UI
          });
      }
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Fetch and display flights data
        fetch("fetch_flights.php")
          .then((response) => response.json())
          .then((data) => {
            const flightsTableBody = document.querySelector(
              "#flightsTable tbody"
            );
            flightsTableBody.innerHTML = data
              .map(
                (flight) => `
              <tr>
                <td>${flight.flight_name}</td>
                <td>${flight.origin}</td>
                <td>${flight.destination}</td>
                <td>${flight.price}</td>
                <td>${flight.travel_date}</td>
                <td>${flight.class}</td>
                <td><img src="uploads/${flight.image}" alt="${flight.flight_name}" width="100" /></td>
                <td>
                  <button onclick="editEntry('flight', ${flight.id})">Edit</button>
                  <button onclick="deleteEntry('flight', ${flight.id})">Delete</button>
                </td>
              </tr>
            `
              )
              .join("");
          });

        // Fetch and display hotels data
        fetch("fetch_hotels.php")
          .then((response) => response.json())
          .then((data) => {
            const hotelsTableBody =
              document.querySelector("#hotelsTable tbody");
            hotelsTableBody.innerHTML = data
              .map(
                (hotel) => `
              <tr>
                <td>${hotel.hotel_name}</td>
                <td>${hotel.location}</td>
                <td>${hotel.services}</td>
                <td>${hotel.description}</td>
                <td><img src="uploads/${hotel.image}" alt="${hotel.hotel_name}" width="100" /></td>
                <td>
                  <button onclick="editEntry('hotel', ${hotel.id})">Edit</button>
                  <button onclick="deleteEntry('hotel', ${hotel.id})">Delete</button>
                </td>
              </tr>
            `
              )
              .join("");
          });

        // Fetch and display tourist sites data
        fetch("fetch_tourist_sites.php")
          .then((response) => response.json())
          .then((data) => {
            const touristSitesTableBody = document.querySelector(
              "#touristSitesTable tbody"
            );
            touristSitesTableBody.innerHTML = data
              .map(
                (site) => `
              <tr>
                <td>${site.site_name}</td>
                <td>${site.location}</td>
                <td>${site.description}</td>
                <td><img src="uploads/${site.image}" alt="${site.site_name}" width="100" /></td>
                <td>
                  <button onclick="editEntry('tourist_site', ${site.id})">Edit</button>
                  <button onclick="deleteEntry('tourist_site', ${site.id})">Delete</button>
                </td>
              </tr>
            `
              )
              .join("");
          });
      });
    </script>
  </body>
</html>
